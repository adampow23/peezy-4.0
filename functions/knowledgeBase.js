/**
 * Peezy Brain - Knowledge Base
 * Complete moving expertise and conversational guidance
 */

const KNOWLEDGE = {
  // ============================================
  // TIMELINE
  // ============================================
  timeline: `
## MOVING TIMELINE

### 8+ Weeks Before Move
- Start decluttering and deciding what to keep/sell/donate
- Research moving companies (especially for long-distance)
- Create moving budget
- If renting: review lease for notice requirements
- If buying: begin home search / make offer
- Start collecting packing supplies

### 6 Weeks Before Move
- Book moving company or reserve truck rental
- Continue packing rarely used items
- Notify landlord if required (check lease for notice period)
- Start researching schools if moving with kids
- Request time off work for move days

### 4 Weeks Before Move
- Continue packing room by room
- Notify employer of address change
- Schedule utility transfers (electric, gas, water)
- Set up internet at new place
- Set up USPS mail forwarding
- Schedule junk removal for items you're not taking
- Get quotes for any services needed (cleaning, etc.)
- Confirm mover booking details

### 2 Weeks Before Move
- Confirm all moving arrangements
- Change address with banks, subscriptions, important accounts
- Arrange pet/child care for move day if needed
- Pack most of the house (leave essentials)
- Prepare "essentials box"
- Refill prescriptions
- Return library books, borrowed items
- Cancel or transfer local services (gym, etc.)

### 1 Week Before Move
- Confirm utility transfer dates
- Finish packing everything except essentials
- Clean out refrigerator (defrost if moving it)
- Take photos of electronic setups before disconnecting
- Get cash for tips
- Charge devices, keep chargers accessible
- Confirm movers have correct addresses and contact info
- Pack a "first night" box with immediate essentials

### Day Before Move
- Pack remaining items
- Disassemble furniture that needs it
- Do final walkthrough of old place
- Confirm arrival time with movers
- Pack overnight bag with essentials
- Prepare cooler with drinks/snacks for move day

### Move Day
- Be present at both locations (or have someone there)
- Direct movers/do final checks
- Do final walkthrough before leaving old place
- Note meter readings at both places
- Keep valuables, essentials, and important documents with you (not on truck)
- Tip movers
- Return keys to old place

### First Week After Move
- Unpack essentials first (bedroom, bathroom, kitchen basics)
- Check that all boxes arrived and note any damage
- Test all utilities (water, electric, gas, internet)
- Update remaining address changes
- Locate nearest essentials (grocery, pharmacy, hospital)
- Get new driver's license and registration if required
- Register to vote at new address
- Introduce yourself to neighbors
`,

  // ============================================
  // COSTS
  // ============================================
  costs: `
## MOVING COSTS REFERENCE

### Local Moves (under 100 miles)
| Home Size | DIY Cost | Professional Movers |
|-----------|----------|---------------------|
| Studio/1BR | $200-500 | $400-800 |
| 2BR | $300-700 | $700-1,200 |
| 3BR | $400-900 | $1,000-2,000 |
| 4BR+ | $500-1,200 | $1,500-3,000 |

Local moves are typically charged by the hour plus truck fee.
Average: $25-50 per mover per hour. Most local moves take 4-8 hours.

### Long-Distance Moves (cross-state/cross-country)
| Home Size | 500 miles | 1,000 miles | 2,000+ miles |
|-----------|-----------|-------------|--------------|
| Studio/1BR | $1,500-2,500 | $2,000-3,500 | $2,500-4,500 |
| 2BR | $2,500-4,000 | $3,500-5,500 | $4,500-7,000 |
| 3BR | $4,000-6,000 | $5,000-8,000 | $6,500-10,000 |
| 4BR+ | $6,000-9,000 | $7,500-12,000 | $9,000-15,000 |

Long-distance moves are based on weight and distance. Average weight:
- 1BR: 2,000-3,000 lbs
- 2BR: 5,000-6,000 lbs
- 3BR: 9,000-10,000 lbs
- 4BR: 12,000-15,000 lbs

### Additional Costs to Budget
| Item | Cost Range |
|------|------------|
| Packing services | +25-50% of moving cost |
| Storage (monthly) | $100-300/month |
| Insurance upgrade | $50-200 |
| Tips | $20-50/mover local, $50-100 long distance |
| Move-out cleaning | $150-400 |
| Utility deposits | $50-200 per utility |
| Moving supplies | $100-300 |
| Pet transport | $300-1,500 (long distance) |
| Auto transport | $800-2,200 (cross-country) |

### Money-Saving Tips
- Move mid-week (Tue-Thu) - can save 10-20%
- Move mid-month (avoid last week of month rush)
- Avoid summer peak season (May-September) - 20-30% higher
- Get multiple quotes (at least 3)
- Declutter before getting quotes (less stuff = lower cost)
- Some items are cheaper to replace than move
- Consider portable containers for flexible packing time
- Ask about military, student, or senior discounts

### Truck Rental Costs (DIY)
| Truck Size | Best For | Local/Day | One-Way |
|------------|----------|-----------|---------|
| 10-12 ft | Studio/1BR | $30-50 | $400-800 |
| 15-17 ft | 2BR | $40-70 | $600-1,200 |
| 20-22 ft | 3BR | $50-90 | $800-1,600 |
| 26 ft | 4BR+ | $70-120 | $1,200-2,200 |

Plus fuel (8-12 mpg), insurance ($15-30/day), and equipment rental.
`,

  // ============================================
  // COMMON MISTAKES
  // ============================================
  commonMistakes: `
## COMMON MOVING MISTAKES TO AVOID

### Planning Mistakes
- **Booking movers too late** - Especially for long-distance. Book 4-6 weeks out minimum.
- **Not getting enough quotes** - Always get at least 3 estimates.
- **Underestimating packing time** - Most people need 2-3x longer than expected.
- **Not reading the fine print** - Understand cancellation policies, insurance coverage, extra fees.
- **Forgetting to budget for all costs** - Tips, deposits, supplies add up.
- **Moving at peak times** - End of month, weekends, summer = higher prices and less availability.

### Packing Mistakes
- **Packing too much** - If you haven't used it in a year, consider letting it go.
- **Not labeling boxes clearly** - Contents AND destination room on every box.
- **Overloading boxes** - Heavy items in small boxes, light items in large boxes.
- **Leaving empty space** - Items shift and break. Fill gaps with paper or bubble wrap.
- **Packing essentials in the truck** - Keep first-night items with you.
- **Wrapping fragile items poorly** - Each item wrapped individually, packed vertically.
- **Not photographing electronics** - Take photos of cable setups before disconnecting.

### Logistics Mistakes
- **Not confirming move date with all parties** - Make sure everyone's aligned.
- **Forgetting to transfer/set up utilities** - Schedule 2 weeks ahead.
- **Not changing address with important accounts** - Start early, continue after move.
- **Not planning for parking/access** - Reserve elevator, get parking permits if needed.
- **Not having cash for tips** - Movers expect cash tips.
- **Leaving perishables in fridge** - Clean it out, defrost if moving it.

### Move Day Mistakes
- **Not being present** - Someone needs to direct at both locations.
- **Not doing final walkthrough** - Check every room, closet, cabinet.
- **Not keeping valuables with you** - Jewelry, documents, medications = personal transport.
- **Not documenting condition of old place** - Photos protect your deposit.
- **Not checking items as loaded/unloaded** - Mark inventory as things move.
- **Letting movers stack boxes wrong** - Heavy on bottom, fragile on top.

### Things People Forget to Do
- Cancel/transfer gym membership
- Update auto insurance (rates change by location)
- Forward mail at movers.usps.com ($1.10)
- Return cable/internet equipment
- Get copies of medical/dental records
- Register to vote at new address
- Update driver's license (usually required within 30-60 days)
- Change address with DMV, banks, credit cards
- Update Amazon, subscription deliveries
- Cancel recurring local services

### Red Flags When Hiring Movers
- No physical address or only a P.O. Box
- Large cash deposit required upfront
- No written estimate
- No DOT number (required for interstate moves)
- Significantly lower quote than everyone else
- Rents space on a shared truck for long distance
- Asks you to sign blank documents
- No company name on truck
`,

  // ============================================
  // CONVERSATION TIPS
  // ============================================
  conversationTips: `
## CONVERSATION GUIDELINES FOR PEEZY

### When User is Overwhelmed
- Acknowledge the feeling FIRST, before anything practical
- Don't pile on more tasks - that makes it worse
- Focus on ONE thing at a time
- Use phrases like: "That's a lot" / "I get it" / "Moving is heavy"
- Remind them they're not alone - you're handling it together
- Break big tasks into tiny, manageable steps
- Ask: "What would make the biggest difference right now?"

### When User is Budget-Conscious
- Don't push expensive options - respect their constraints
- Lead with DIY alternatives where appropriate
- Prioritize must-haves vs nice-to-haves
- Be transparent about costs - no surprises
- Look for money-saving opportunities to share
- Say: "For a tight budget, here's what I'd focus on..."
- Never make them feel bad about their budget

### When User is a First-Time Mover
- Explain more, assume less about their knowledge
- Share common mistakes to avoid
- Be encouraging - moving is manageable
- Extra check-ins on progress are helpful
- Use more specific guidance, less "you could..."
- Frame things positively - they've got this

### When User is Experienced
- Be more concise - they know the basics
- Focus on logistics, not education
- Respect their knowledge and preferences
- Offer efficiency and convenience, not hand-holding
- Skip explanations of obvious things
- Ask about their preferred approach

### When User Has Special Items (Piano, Safe, Art, etc.)
- Take inventory seriously - these matter
- Recommend specialists when appropriate
- Discuss insurance/valuation options
- Don't let them underestimate the challenge
- Regular movers may decline or charge extra

### When Things Go Wrong
- Stay calm and solution-focused
- Document everything immediately
- Know the escalation path (Peezy → vendor → claim)
- Remind them of Peezy's accountability model
- Follow up until resolved - don't let it drop
- Be their advocate with the vendor

### When User Wants to Book Outside Peezy
- Acknowledge positively - no guilt trip
- Offer to help if issues arise
- Move on to the next topic
- Don't be passive-aggressive
- It's their choice - respect it

### When Discussing Peezy's Value
- Lead with accountability: vendors perform or lose access
- Same services available elsewhere, but with consequences
- Don't oversell - be matter-of-fact
- Only explain fully once, then brief references
- Don't repeat the full pitch if they've heard it

### Tone and Voice
DO:
- Use contractions (you're, I'll, that's, it's)
- Be direct and specific
- Ask targeted questions
- Acknowledge emotions and milestones
- Use the user's name occasionally (not every message)
- End with clear next steps or questions

DON'T:
- Say "How can I help you?" or "What would you like to do?"
- Say "I'm here to assist" or "Let me know if you have questions"
- Use bullet points in casual conversation
- Repeat information they already know
- Be overly formal or robotic
- Use exclamation points excessively
- Give long explanations when short ones work
`
};

// Get specific knowledge section
function getKnowledge(section) {
  return KNOWLEDGE[section] || null;
}

// Get relevant knowledge for context
function getRelevantKnowledge(userState, topic) {
  const relevant = [];
  
  // Add timeline info if early in planning
  if (userState.daysUntilMove > 30) {
    relevant.push({ section: 'timeline', relevance: 'planning phase' });
  }
  
  // Add costs info if budget-conscious
  if (userState.budget === 'tight') {
    relevant.push({ section: 'costs', relevance: 'budget-conscious user' });
  }
  
  // Add conversation tips based on user profile
  relevant.push({ section: 'conversationTips', relevance: 'always relevant' });
  
  return relevant;
}

// Export
module.exports = {
  KNOWLEDGE,
  getKnowledge,
  getRelevantKnowledge
};
